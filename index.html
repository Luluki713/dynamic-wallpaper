<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>iPad 全屏美女动态壁纸</title>

<!-- iOS Web App 全屏 -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<style>
  html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    overflow: hidden;
    background: #000;
  }
  #wallpaper {
    width: 100%;
    height: 100%;
    background-size: cover;
    background-position: center;
    position: absolute;
    top: 0;
    left: 0;
    transition: opacity 1.5s ease-in-out, transform 20s linear;
    opacity: 0;
    transform: scale(1);
  }
</style>
</head>
<body>
<div id="wallpaper"></div>

<script>
const wallpaper = document.getElementById('wallpaper');
const intervalTime = 10000; // 每10秒切换
const preloadCount = 5; // 初始预加载图片数量

let preloadedImages = [];
let currentIndex = 0;

// 预加载单张美女图片
async function preloadImage() {
  try {
    const imgSrc = `https://source.unsplash.com/1920x1080/?portrait,girl&sig=${Math.floor(Math.random()*10000)}`;
    const img = new Image();
    img.src = imgSrc;
    await new Promise(resolve => { img.onload = resolve; });
    return img.src;
  } catch (err) {
    console.error('获取图片失败', err);
    return null;
  }
}

// 预加载多张图片
async function preloadImages(count) {
  preloadedImages = [];
  for (let i = 0; i < count; i++) {
    const src = await preloadImage();
    if (src) preloadedImages.push(src);
  }
}

// 切换图片函数
function changeWallpaper() {
  if (preloadedImages.length === 0) return;
  wallpaper.style.opacity = 0; // 淡出
  setTimeout(() => {
    wallpaper.style.backgroundImage = `url('${preloadedImages[currentIndex]}')`;
    wallpaper.style.opacity = 1; // 淡入
    wallpaper.style.transform = `scale(${1 + Math.random() * 0.05})`; // 轻微缩放
    currentIndex = (currentIndex + 1) % preloadedImages.length;
  }, 500);

  // 异步补充下一张图片
  if (currentIndex === preloadedImages.length - 1) {
    preloadImage().then(src => {
      if (src) preloadedImages.push(src);
    });
  }
}

// 初始化
(async function init() {
  await preloadImages(preloadCount);
  changeWallpaper();
  setInterval(changeWallpaper, intervalTime);
})();
</script>
</body>
</html>
